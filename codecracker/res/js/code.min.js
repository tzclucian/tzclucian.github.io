var CODE_LENGTH=0;var CODE="";var TIME=0;var DISTANCE=0;var SECONDS_LOSS_PER_TRY=10;var TOTAL_TIME_LOSS=0;var IS_SETUP_DONE=false;var IS_INITIALISED=false;var TRY_INDEX=0;var CORRECT_CLASS="correct";var WRONG_CLASS="wrong";var MISPLACED_CLASS="misplaced";var INDEX_CLASS="index";var TIMER=undefined;function boot(){$("#init_button").removeAttr("disabled");$("#time").removeAttr("disabled");$("#code_length").removeAttr("disabled");$("#time_loss").removeAttr("disabled");$("#code-initialised-status").html("waiting...");$("#verify_button").hide();$("#setup_button").hide();$("#init_button").show();$("#init_section").show();if(TIMER){TIMER.stop()}CODE_LENGTH=0;CODE="";TIME=0;DISTANCE=0;SECONDS_LOSS_PER_TRY=10;TOTAL_TIME_LOSS=0;IS_SETUP_DONE=false;IS_INITIALISED=false;TRY_INDEX=0;CORRECT_CLASS="correct";WRONG_CLASS="wrong";MISPLACED_CLASS="misplaced";INDEX_CLASS="index";$("#code_input").val("");TIMER=undefined}function bodyLoad(){boot();TIME=parseInt($("#time").val());TIMER=$(".clock").FlipClock(TIME,{countdown:true,clockFace:"MinuteCounter",autoStart:false})}function initialiseCodeParameters(){CODE_LENGTH=parseInt($("#code_length").val());TIME=parseInt($("#time").val());SECONDS_LOSS_PER_TRY=parseInt($("#time_loss").val());$("#init_button").attr("disabled",true);$("#init_button").hide();IS_INITIALISED=true;$("#time").attr("disabled",true);$("#code_length").attr("disabled",true);$("#time_loss").attr("disabled",true);$("#code-initialised-status").html("Initialised");TIMER=$(".clock").FlipClock(TIME,{countdown:true,clockFace:"MinuteCounter",autoStart:false,callbacks:{interval:function(){var a=TIMER.getTime().time;if(a===0){TIMER.stop();$("#fail_modal").modal("show");$("#init_button").attr("disabled","disabled");$("#setup_button").attr("disabled","disabled");$("#setup_button").hide();$("#verify_button").attr("disabled","disabled");$("#verify_button").hide();$("#keypad").attr("disabled","disabled");IS_INITIALISED=false}}}})}function updateCode(b){var c=document.forms[0].code;var a=false;if(c.value.indexOf(b)>-1){a=true}if(c.value.length<CODE_LENGTH&&IS_INITIALISED&&!a){c.value=c.value+b}else{console.log("Limit exceeded! Ignoring...")}if(c.value.length===CODE_LENGTH&&!IS_SETUP_DONE&&IS_INITIALISED){$("#setup_button").removeAttr("disabled");$("#setup_button").show()}if(c.value.length===CODE_LENGTH&&IS_SETUP_DONE){$("#verify_button").removeAttr("disabled");$("#verify_button").show()}}function setupCode(){CODE=$("#code_input").val();IS_SETUP_DONE=true;$("#code_input").val("");$("#setup_button").attr("disabled","disabled");$("#setup_button").hide();TIMER.start();$("#init_section").hide();console.log("Setup CODE: "+CODE)}function verifyCode(){var a=$("#code_input").val();var k=$("<tr></tr>").attr("id",TRY_INDEX);var g=$("<td> #"+(TRY_INDEX+1)+"</td>").addClass(INDEX_CLASS);g.appendTo(k);for(var f=0;f<CODE_LENGTH;f++){var e="";var h=(" "+CODE).slice(1);var j=a[f];var c=h[f];if(c===j){e=CORRECT_CLASS;h[f]="/"}else{if(h.includes(j)){e=MISPLACED_CLASS}else{e=WRONG_CLASS}}var b=TRY_INDEX.toString()+f.toString();var d=$("<td>"+j+"</td>").attr("id",b).addClass(e);d.appendTo(k)}if(TRY_INDEX==0){k.appendTo($("#results"))}else{$("#"+(TRY_INDEX-1)).before(k)}if(a===CODE){TIMER.stop();$("#timer").innerHTML="SUCCESS!";$("#dialog-code").html("Code was successfully cracked: "+CODE);$("#success_modal").modal("show")}TIMER.getTime().subSeconds(SECONDS_LOSS_PER_TRY);$("#code_input").val("");$("#verify_button").attr("disabled","disabled");$("#verify_button").hide();TRY_INDEX=TRY_INDEX+1};