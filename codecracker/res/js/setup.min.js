var CODE_LENGTH=0;var CODE="";var TIME=0;var DISTANCE=0;var SECONDS_LOSS_PER_TRY=10;var TOTAL_TIME_LOSS=0;var IS_SETUP_DONE=!1;var IS_INITIALISED=!1;var TRY_INDEX=0;var CORRECT_CLASS="correct";var WRONG_CLASS="wrong";var MISPLACED_CLASS="misplaced";var INDEX_CLASS="index";var TIMER=undefined;function bodyLoad(){TIME=parseInt($('#time').val());TIMER=$('.clock').FlipClock(TIME,{countdown:!0,clockFace:'MinuteCounter',autoStart:!1})}
function initialiseCodeParameters(){CODE_LENGTH=parseInt($("#code_length").val());TIME=parseInt($('#time').val());SECONDS_LOSS_PER_TRY=parseInt($('#time_loss').val());$("#init_button").attr("disabled",!0);IS_INITIALISED=!0;$('#time').attr('disabled',!0);$('#code_length').attr('disabled',!0);$('#time_loss').attr('disabled',!0);$('#code-initialised-status').html("Init");TIMER=$('.clock').FlipClock(TIME,{countdown:!0,clockFace:'MinuteCounter',autoStart:!1,callbacks:{interval:function(){var time=TIMER.getTime().time;if(time===0){TIMER.stop();$('#fail_modal').modal('show')}}}})}
function updateCode(key){var code=document.forms[0].code;if(code.value.length<CODE_LENGTH&&IS_INITIALISED){code.value=code.value+key}else{console.log("Limit exceeded! Ignoring...")}
    if(code.value.length===CODE_LENGTH&&!IS_SETUP_DONE&&IS_INITIALISED){$('#setup_button').removeAttr('disabled')}
    if(code.value.length===CODE_LENGTH&&IS_SETUP_DONE){$('#verify_button').removeAttr('disabled')}}
function setupCode(){CODE=$('#code_input').val();IS_SETUP_DONE=!0;$('#code_input').val("");$('#setup_button').attr('disabled','disabled');TIMER.start();console.log("Setup CODE: "+CODE)}
function verifyCode(){var actualCode=$('#code_input').val();var newRow=$('<tr></tr>').attr('id',TRY_INDEX);var indexCell=$('<td> #'+(TRY_INDEX+1)+'</td>').addClass(INDEX_CLASS);indexCell.appendTo(newRow);for(var i=0;i<CODE_LENGTH;i++){var cellClass="";var correctCodeClone=(' '+CODE).slice(1);var actualSymbol=actualCode[i];var correctSymbol=correctCodeClone[i];if(correctSymbol===actualSymbol){cellClass=CORRECT_CLASS;correctCodeClone[i]="/"}else if(correctCodeClone.includes(actualSymbol)){cellClass=MISPLACED_CLASS}else{cellClass=WRONG_CLASS}
    var cellId=TRY_INDEX.toString()+i.toString();var newCell=$('<td>'+actualSymbol+'</td>').attr('id',cellId).addClass(cellClass);newCell.appendTo(newRow)}
    if(TRY_INDEX===0){newRow.appendTo($('#results'))}else{$('#'+(TRY_INDEX-1)).before(newRow)}
    if(actualCode===CODE){TIMER.stop();$('#timer').innerHTML="SUCCESS!";$('#dialog-code').html('Code was successfully cracked: '+CODE);$('#success_modal').modal('show')}
    TIMER.getTime().subSeconds(SECONDS_LOSS_PER_TRY);$('#code_input').val("");$('#verify_button').attr('disabled','disabled');TRY_INDEX=TRY_INDEX+1}